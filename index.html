<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="DVID Web Server Home Page" />

    <link rel="stylesheet" type="text/css" media="screen" href="/css/stylesheet.css">

    <title>DVID Web Server</title>
</head>

<body>

<!-- HEADER -->
<div id="header_wrap" class="outer">
    <header class="inner">
        <a id="forkme_banner" href="https://github.com/janelia-flyem/dvid">View DVID on GitHub</a>

        <h1 id="project_title">Medulla Single Column</h1>
        <h2 id="project_tagline">FIB-SEM data and groundtruth segmentation</h2>
    </header>
</div>

<!-- MAIN CONTENT -->
<div id="main_content_wrap" class="outer">
    <section id="main_content" class="inner">
        <h3>What is this website?</h3>

        <p>
            This website is a single DVID server that publishes one-column of Drosophila medulla data:
             ground truth labels plus original grayscale.  (Please see the license at the bottom of the page.)
            The <a href="/console/index.html">DVID admin console</a> shows the single dataset 
            repository and instances of built-in DVID data types like 8-bit grayscale, 64-bit labels,
            composite RGBA images, and a keyvalue.
        </p>
        <p>
            Here are some example grayscale and labeled images from the published dataset:
        </p>
        <table>
            <tr>
                <td><img src="/images/grayscale-xy.jpg" /></td>
                <td><img src="/images/grayscale-xz.jpg" /></td>
                <td><img src="/images/segmentation.jpg" /></td>
            </tr>
        </table>
        <p>
            A tutorial is provided below that will help you understand the DVID open-source server and
            how to extract the published data in a variety of ways.
        </p>
        
        <h4>Downloading the Data</h4>
        
        <p>
            You can explore the data through the DVID API or you can download the grayscale and
            label data directly using simple HTTP requests.  For example, the following bash script assumes you have
            <code>wget</code> installed and downloads XY images for the grayscale from Z position of 1376 to 7615:
        </p>
        <pre><code>
for i in {1376..7615}
do 
    wget http://emdata.janelia.org/api/node/bf1/grayscale/raw/xy/2000_2000/1800_2300_$i -O grayscale-xy-$i.png
done
        </code></pre>
        <p>
            By changing the <em>grayscale</em> in the above URL to <em>bodies</em>, you can retrieve the 64-bit label
            images.
        </p>
    
        <h4>Exploring DVID commands and HTTP API</h4>
        <p>
                DVID documentation can be found on the extensive <a href="https://github.com/janelia-flyem/dvid#dvid-">README</a> 
                on github as well as the automatically updated <a href="https://godoc.org/github.com/janelia-flyem/dvid">Go Doc
                documentation</a>.  Note that a single DVID executable is providing the web server for these pages,
    	    an RPC server for remote command-line access, and the core system that manages versioned data
    	    access and processing using pluggable storage engines, which is an embedded Basho-tuned leveldb
    	    database in this case.
        </p>
        <p>
            Each data type within DVID exposes commands and a HTTP API allowing clients like this browser to retrieve and put data.
            Command-line and HTTP API documentation is currently distributed over a variety of data types.  Visit
            the <a href="/api/help">/api/help HTTP endpoint</a> on a running DVID server to review the current API.
        <p>
        <p>
            This particular DVID server has a data instance of four different built-in data types:
            <ul>
                <li><strong>grayscale</strong> instance of <strong>grayscale8</strong> data type</li>
                <li><strong>bodies</strong> instance of <strong>labels64</strong> data type</li>
                <li><strong>composite</strong> instance of <strong>rgba8</strong> data type</li>
		<li><strong>files</strong> instance of <strong>keyvalue</strong> data type</li>
            </ul>
            The <strong>grayscale</strong> instance is the 8-bit FIB grayscale.  The <strong>bodies</strong> instance
            is the 64-bit label data generated by our segmentation and proofreading process. 
            The <strong>composite</strong> instance is a pseudo-coloring of the grayscale using the segmentation,
            which can be generated by a DVID command.  
	    The <strong>files</strong> instance shows how we use the keyvalue data type as a quick file or data blob
	    repository.  We have stored one key-value pair in <strong>files</strong>: a JSON file with synapse
     	    annotations under the "<a href="/api/node/bf1/files/synapses.json/">synapses.json</a>" key.
	</p>

	<p>The <a href="/api/repos/info">/api/repos/info</a> 
	    endpoint provides details about all repositories and the data they contain in JSON format.
        </p>

        <p>
            The repository on this server (emdata.janelia.org) was created by issuing a DVID "push" command on the 
            grayscale and bodies data from an internal janelia server:
        </p>
        <p>
            <code>% dvid repo bf1 push <em>tcp-address</em> data=grayscale,bodies roi=onecolumn</code>
        </p>
        <p>
            This command cloned the repository with UUID bf18071e356211e4b325c81f66eb987e
            (only a unique prefix of the UUID is necessary, e.g., "bf1"), which is a much larger seven-column
            dataset.  The optional "<em>data=...</em>" limited the 
            transmitted data to the grayscale and bodies instances, while the optional "<em>roi=onecolumn</em>" limited
            the extents to the "onecolumn" instance of an ROI data type.
        </p>

        <p>
            After the push, on the public emdata.janelia.org server, we created the composite
            data instance by manually issuing a labels64 "composite" comand as described in the 
            <a href="/api/help/labels64">labels64 help documentation</a>.
        </p>

        <h6>GET image</h6>
        
        <p>
            To extract a 1000 x 800 pixel 2d image with XY orientation from the FIB grayscale data, we make a GET
            call handled by the <em>grayscale</em> instance of 
	    the <a href="/api/help/grayscale8">grayscale8 data type</a>:
        </p>
        <p>
            <a target="_blank" href="http://emdata.janelia.org/api/node/bf1/grayscale/raw/xy/1000_800/2600_3200_3000">
            <code>http://emdata.janelia.org/api/node/bf1/grayscale/raw/xy/1000_800/2600_3200_3000</code>
            </a><br />
            <center>(Click on URL above to see result)</center>
        </p>
	<p>
        <p>
            Or look at an XZ-oriented image:
        </p>
        <p>
            <a target="_blank" href="http://emdata.janelia.org/api/node/bf1/grayscale/raw/xz/1000_800/2500_3600_3000">
            <code>http://emdata.janelia.org/api/node/bf1/grayscale/raw/<strong>xz</strong>/1000_800/2500_3600_3000</code>
            </a><br />
            <center>(Click on URL above to see result)</center>
        </p>
	<p>
	    Note that the one-column data is within a large, mostly empty coordinate space that is aligned
	    to our much larger FIB-25 dataset.  Empty voxel blocks are not stored in DVID.
	    Also, the retrieved image is constructed on-the-fly by DVID from blocks intersected by the requested
	    image. Precomputed tile images can be built using the 
	    <a href="/api/help/multiscale2d"><em>multiscale2d</em> data type API</a>. 
	</p>
        <p>
            You can look at the segmentation results by inspecting the <em>composite</em> data instance of the
	    the built-in rgba8 data type:
        </p>
        <p>
            <a target="_blank" href="http://emdata.janelia.org/api/node/bf1/composite/raw/xy/1000_800/2600_3200_3000">
            <code>http://emdata.janelia.org/api/node/bf1/<strong>composite</strong>/raw/xy/1000_800/2600_3200_3000</code>
            </a><br />
        </p>


        <h3>Licensing</h3>
        <p>
            This one-column medulla dataset is made available under the Open Data Commons Attribution License: 
            <a href="http://opendatacommons.org/licenses/by/1.0/">http://opendatacommons.org/licenses/by/1.0/</a>.
            A simple description of the license is <a href="http://opendatacommons.org/licenses/by/summary/">provided here</a>.
        </p>
        <p>
            DVID is released under the
            <a href="http://janelia-flyem.github.com/janelia_farm_license.html">Janelia Farm license</a>, a
            <a href="http://en.wikipedia.org/wiki/BSD_license#3-clause_license_.28.22New_BSD_License.22_or_.22Modified_BSD_License.22.29">
            3-clause BSD license</a>.
        </p>
    </section>
</div>

<!-- FOOTER -->
<div id="footer_wrap" class="outer">
    <footer class="inner"></footer>
</div>

</body>
</html>
